<h2 mat-dialog-title>{{ product.nombre }}</h2>

<div mat-dialog-content>
  <div style="display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 16px;">
    <div style="display: flex; flex-direction: column;">
      <label style="margin-bottom: 8px; font-weight: 500;">Termino</label>
      <mat-selection-list style="flex: 1; overflow-y: auto;">
        @for (term of product.terminos; track term.idpvTerminos) {
          <mat-list-option [selected]="termsSelection.isSelected(term)" (click)="termsSelection.toggle(term)">
            {{ term.nombre }}
          </mat-list-option>
        }
      </mat-selection-list>
    </div>

    <div>
      <form (ngSubmit)="submit()" [formGroup]="form">
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
          <mat-form-field>
            <mat-label>Cantidad</mat-label>
            <input matInput readonly [formControl]="form.controls.quantity">
            <button mat-icon-button matSuffix type="button" [disabled]="form.controls.quantity.disabled || form.controls.quantity.value <= 1"
              (click)="form.controls.quantity.setValue(form.controls.quantity.value - 1)">
              <mat-icon>remove</mat-icon>
            </button>
            <button mat-icon-button matSuffix type="button" [disabled]="form.controls.quantity.disabled"
              (click)="form.controls.quantity.setValue(form.controls.quantity.value + 1)">
              <mat-icon>add</mat-icon>
            </button>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Precio</mat-label>
            <input matInput [value]="form.controls.price.value | currency" readonly>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Total</mat-label>
            <input matInput [value]="form.controls.total.value | currency" readonly>
          </mat-form-field>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 8px;">
          <div>
            <label style="display: block; margin-bottom: 8px;">Orden</label>
            <mat-button-toggle-group formControlName="half" style="width: 100%;">
              <mat-button-toggle [value]="false" style="width: 50%;">Completa</mat-button-toggle>
              <mat-button-toggle [value]="true" [disabled]="!product.precioMedia" style="width: 50%;">Media</mat-button-toggle>
            </mat-button-toggle-group>
          </div>

          <div>
            <label style="display: block; margin-bottom: 8px;">Cocina</label>
            <mat-button-toggle-group formControlName="kitchen" style="width: 100%; display: flex;">
              @for (k of kitchens; track k.idpvCocinas) {
                <mat-button-toggle [value]="k.idpvCocinas" style="flex: 1;">{{ k.nombre }}</mat-button-toggle>
              }
            </mat-button-toggle-group>
          </div>

          <div>
            <label style="display: block; margin-bottom: 8px;">{{ form.controls.time.value }}Â° Tiempo</label>
            <mat-button-toggle-group formControlName="time" style="width: 100%; display: flex;">
              @for (n of [] | range : 5 : 1; track n) {
                <mat-button-toggle [value]="n" style="flex: 1;">{{ n }}</mat-button-toggle>
              }
            </mat-button-toggle-group>
          </div>

          <div>
            <label style="display: block; margin-bottom: 8px;">Subcuenta {{ form.controls.sub.value }}</label>
            <mat-button-toggle-group formControlName="sub" style="width: 100%; display: flex;">
              @for (n of [] | range : 5 : 1; track n) {
                <mat-button-toggle [value]="n" style="flex: 1;">{{ n }}</mat-button-toggle>
              }
            </mat-button-toggle-group>
          </div>
        </div>

        <mat-form-field style="width: 100%; margin-top: 16px;">
          <mat-label>Notas</mat-label>
          <textarea matInput [formControl]="form.controls.notes" rows="3"></textarea>
        </mat-form-field>
      </form>
    </div>

    <div style="display: flex; flex-direction: column;">
      <label style="margin-bottom: 8px; font-weight: 500;">Modificadores</label>
      <mat-selection-list style="flex: 1; overflow-y: auto;">
        @for (modifier of product.modificadores; track modifier.idpvPlatillosModificadores) {
          <mat-list-option [selected]="modifiersSelection.isSelected(modifier)" (click)="modifiersSelection.toggle(modifier)">
            {{ modifier.nombre }}
          </mat-list-option>
        }
      </mat-selection-list>
    </div>
  </div>
</div>

<mat-progress-bar [mode]="form.disabled ? 'indeterminate': 'determinate'"></mat-progress-bar>

<div mat-dialog-actions align="end">
  <button matButton (click)="cancel()" [disabled]="form.disabled">Cancelar</button>
  <button matButton="filled" (click)="submit()" [disabled]="form.disabled">
    Agregar
  </button>
</div>
